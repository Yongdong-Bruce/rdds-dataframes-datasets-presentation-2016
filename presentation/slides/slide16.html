<section>
  <h1>Datasets and the DataFrame API</h1>

  <p>With Datasets, you can still access the DataFrame query API.</p>

  <p>RDDs:</p>

  <div class="code">
    <pre>
      <code class="scala">
val lines = sc.textFile("hdfs://path/to/some/ebook.txt")
val words = lines.flatMap(_.split("""\s+""")).filter(_.nonEmpty)
val counts = words.groupBy(_.toLowerCase).map { case (w, all) => (w, all.size) }
      </code>
    </pre>
  </div>

  <p>Datasets:</p>

  <div class="code">
    <pre>
      <code class="scala">
val lines = sqlContext.read.text("hdfs://path/to/some/ebook.txt").as[String]
val words = lines.flatMap(_.split("""\s+""")).filter(_.nonEmpty)
val counts = words.groupBy(_.toLowerCase).count()
      </code>
    </pre>
  </div>
</section>
