<section>
  <h1>RDDs: Some code</h1>

  <p>
    This blob of code creates an RDD from a file on a distributed file system.
    The file contains an hour's worth of Wikipedia edits.
  </p>

  <div class="code">
    <pre>
      <code class="scala" data-trim>
val rdd = sc.textFile("hdfs:/user/bmc/wikipedia-pagecounts.gz")
val parsedRDD = rdd.flatMap { line =>
  line.split("""\s+""") match {
    case Array(project, _, numRequests, _) => Some((project, numRequests))
    case _ => None
  }
}

parsedRDD.filter { case (project, numRequest) => project == "en" }.
          reduceByKey(_ + _).
          take(100).
          sortBy({ case (page, numRequests) => numRequests}, ascending = false).
          foreach { case (page, requests) => println(s"$page: $requests") }
      </code>
    </pre>
  </div>

  <aside class="notes">
    Put the `take()` after the sort, for instance, and you will really
    slow things down.
  </aside>

</section>
